#include<iostream>
#include<fstream>
#include<cstdio>
#include<vector>
#include<algorithm>
#define MAX 1000000000
using namespace std;

struct Query {
	int type;
	int a;
	int b;
};

struct Edge {
	int src;
	int dest;
	bool avail;
};

vector<Edge> edge;
vector<Query> Q;
int P[100001];
int W[100001];

int find(int N) {
	if (P[N] == N) {
		return N;
	}
	return P[N] = find(P[N]);
}

void uni(int a, int b) {
	int pa = find(a);
	int pb = find(b);

	if (pa == pb) {
		return;
	}

	if (W[pa] < W[pb]) {
		P[pa] = pb;
	}
	else if (W[pa] > W[pb]) {
		P[pb] = pa;
	}
	else {
		P[pa] = pb;
		W[pb]++;
	}

}

int main() {
	ifstream f("input.txt");
	int CA;
	f >> CA;

	for (int ca = 1; ca <= CA; ca++) {
		int V, E;
		f >> V >> E;

		edge.clear();
		Q.clear();
		for (int i = 1; i <= V; i++) {
			P[i] = i;
			W[i] = 1;
		}

		for (int i = 1; i <= E; i++) {
			int s, e;
			f >> s >> e;
			edge.push_back({ s, e, true });

		}

		//insert query
		int q;
		f >> q;
		for (int i = 1; i <= q; i++) {
			int t, a, b = 0;
			f >> t;
			if (t == 1) {
				f >> a;
				Q.push_back({ t, a - 1, 0 });
				edge[a - 1].avail = false;
			}
			else if (t == 2) {
				f >> a >> b;
				Q.push_back({ t, a, b });
			}
		}

		//make disjoint set
		for (auto e : edge) {
			if (e.avail) {
				uni(e.src, e.dest);
			}
		}

		/*
		for (int i = 1; i <= V; i++) {
			cout << P[i] << ' ';
		}
		cout << endl;
		*/


		//searching reverse
		vector<int> res;
		
		while (!Q.empty()) {
			Query q = Q.back();
			Q.pop_back();
			if (q.type == 1) {
				edge[q.a].avail = true;
				uni(edge[q.a].src, edge[q.a].dest);
			}
			else if (q.type == 2) {
				if (find(q.a) == find(q.b)) {
					res.push_back(1);
				}
				else {
					res.push_back(0);
				}
			}
		}

		//print result
		printf("#%d ", ca);
		while (!res.empty()) {
			printf("%d", res.back());
			res.pop_back();
		}
		printf("\n");
		
	}
	return 0;
}


===============================================

7
8 12
3 2
6 7
3 8
8 5
6 2
2 1
1 4
7 8
6 3
5 1
7 4
2 5
20
2 4 6
1 7
2 4 6
1 2
1 10
2 8 6
1 9
1 5
1 12
2 6 5
1 6
1 3
1 11
2 6 4
2 1 6
2 8 7
1 4
1 8
2 2 3
2 7 8
8 12
3 7
6 7
1 8
4 7
4 6
1 4
1 6
7 5
6 3
2 1
2 4
1 7
20
2 5 1
1 8
1 2
1 5
2 2 5
1 4
2 7 5
2 5 1
2 8 5
1 6
2 5 6
1 10
2 4 1
1 12
2 7 5
1 7
1 9
2 6 7
2 2 4
1 11
8 12
3 6
5 2
8 1
4 3
6 2
7 4
4 6
5 8
4 5
7 5
3 2
8 4
20
1 6
2 1 8
1 2
2 8 1
1 5
1 10
2 2 7
2 4 7
1 8
1 11
1 3
2 4 6
2 4 3
1 7
2 3 5
1 4
2 3 6
1 9
2 6 7
1 12
8 12
6 4
7 3
4 5
2 1
7 1
8 3
7 4
3 5
6 1
4 1
7 6
4 2
20
2 2 6
1 7
2 5 4
1 9
1 8
2 5 3
1 12
1 1
1 6
2 8 7
1 4
1 5
2 2 3
2 8 1
2 1 5
1 3
1 2
2 3 5
2 6 7
1 10
50 100
48 24
22 16
32 41
42 19
11 31
6 4
27 41
26 16
7 6
25 22
5 26
14 1
39 44
14 16
45 43
39 18
4 10
50 2
46 3
5 19
22 36
37 4
13 8
26 22
44 29
41 7
27 38
24 50
46 36
32 36
28 41
46 17
36 34
15 33
45 30
38 3
14 13
23 42
11 47
25 44
20 42
30 44
7 21
33 5
46 11
46 42
34 14
18 37
34 37
19 46
28 14
29 19
14 18
9 11
35 15
48 7
18 16
21 45
32 21
37 11
34 2
7 30
48 13
25 7
15 21
6 32
4 5
6 12
47 23
13 6
21 43
40 15
44 24
15 4
37 8
30 33
30 2
3 43
25 6
5 45
19 21
34 35
2 8
2 29
32 8
4 12
10 5
17 9
20 38
35 37
31 19
21 37
13 43
38 48
19 37
33 16
10 2
1 33
25 31
46 44
300
2 37 18
2 16 49
2 49 24
1 95
2 49 43
2 13 12
2 49 39
1 71
2 49 8
1 100
2 31 49
2 14 49
2 49 34
2 30 49
2 15 49
2 49 7
1 5
2 25 49
2 35 49
1 40
2 49 1
2 49 34
2 2 49
1 70
2 49 16
2 24 16
2 31 27
2 33 49
2 14 49
2 21 2
2 49 16
1 34
2 42 21
2 49 15
2 8 43
1 66
1 81
2 2 49
2 25 6
2 26 28
2 1 9
2 6 49
2 8 49
2 49 22
2 49 28
2 13 45
2 49 25
2 49 26
2 1 49
2 42 35
1 82
2 25 49
1 24
2 46 42
1 68
2 21 49
1 20
2 49 20
2 49 5
2 49 38
2 30 49
1 99
2 2 49
2 35 17
2 8 49
1 41
2 35 49
1 86
1 13
1 18
2 50 34
1 50
2 49 29
2 23 12
1 49
2 49 31
2 33 1
2 15 12
2 12 38
1 2
2 39 37
2 49 12
2 49 12
2 49 12
2 18 34
2 31 17
2 3 49
2 12 8
2 49 35
2 17 12
2 49 26
1 59
1 11
1 84
1 17
1 6
2 26 46
2 49 30
1 4
2 29 41
2 42 28
2 7 49
1 69
2 50 3
1 28
1 48
2 6 25
2 12 50
2 50 49
1 87
1 3
2 30 46
1 39
1 88
1 42
2 8 18
2 23 48
2 12 49
1 36
1 97
2 12 10
1 31
1 98
1 51
2 50 47
2 13 28
1 74
1 57
1 78
1 7
1 30
2 32 27
1 32
1 55
1 63
1 92
2 10 50
2 34 12
2 35 12
2 10 12
2 3 17
1 46
1 91
2 47 49
1 64
1 60
1 85
2 5 38
1 9
1 25
2 41 14
2 42 29
1 79
2 29 19
1 27
2 19 6
1 47
2 28 12
2 12 11
2 29 49
2 42 23
2 19 28
1 90
2 29 19
2 42 23
2 12 32
2 20 30
1 94
2 19 29
1 83
2 10 29
1 8
2 20 47
2 38 20
2 35 12
2 23 42
2 19 29
1 44
2 29 49
2 10 12
2 31 49
1 10
2 47 49
2 10 17
2 28 29
1 75
2 29 32
1 33
1 29
2 23 19
2 47 32
2 38 47
2 9 46
2 47 50
2 19 29
2 10 28
2 50 27
2 38 47
1 53
1 89
2 46 29
1 37
1 23
2 42 39
2 20 26
2 19 29
2 8 20
2 36 22
1 52
2 36 22
2 42 23
2 23 42
2 33 40
2 23 42
2 31 28
1 22
1 93
1 76
2 25 19
1 96
1 62
2 17 31
2 10 1
1 65
2 37 47
2 20 29
2 10 9
1 38
2 10 35
2 12 15
2 9 46
2 50 25
2 37 17
2 40 30
1 21
2 9 46
2 20 1
2 10 17
2 4 43
2 40 15
1 12
2 37 39
2 3 11
2 32 12
1 43
2 22 24
2 37 13
2 32 47
1 19
2 49 29
2 20 23
2 50 33
2 31 50
1 56
2 31 41
1 67
2 27 21
2 15 40
1 72
2 46 49
1 26
2 36 28
2 48 44
2 27 50
1 1
2 17 23
2 18 10
2 50 25
1 54
2 1 6
2 18 25
2 38 6
2 9 6
2 43 40
2 29 28
2 24 44
1 77
2 46 1
2 3 6
2 4 3
2 19 15
1 14
1 58
2 20 35
2 19 12
1 15
2 12 48
2 16 38
1 73
2 12 14
2 23 9
2 34 2
2 11 46
2 5 45
1 35
2 5 45
2 2 34
2 6 14
1 16
1 45
50 100
39 25
37 15
2 49
27 28
38 35
17 44
42 11
23 39
7 48
27 15
48 31
47 27
9 29
50 18
44 31
10 37
43 40
39 34
9 2
48 3
6 8
37 13
4 27
24 28
47 43
49 5
10 22
27 41
12 33
33 32
40 39
28 9
17 47
4 13
3 26
13 20
1 16
46 18
15 39
37 19
17 12
28 50
18 13
41 24
43 41
37 17
22 7
1 32
26 5
38 40
29 6
38 25
1 25
27 22
7 1
14 47
42 45
8 14
36 12
41 9
14 25
28 48
45 11
31 17
7 13
30 38
44 46
30 41
24 25
38 11
24 48
25 6
20 41
20 44
23 15
46 27
31 4
36 28
35 28
45 43
38 36
26 46
14 40
3 32
41 6
32 23
34 1
37 30
16 33
30 1
4 47
17 41
6 37
28 44
21 45
43 18
29 13
43 13
38 15
25 34
300
2 29 33
1 20
1 41
2 27 47
1 1
2 20 24
2 43 39
2 38 17
2 20 29
2 34 4
1 26
2 50 10
2 16 9
2 19 5
2 42 18
2 7 4
2 40 24
1 23
2 44 49
2 17 47
2 30 32
2 28 42
2 35 48
2 24 40
2 3 45
1 30
2 12 14
1 11
2 22 46
1 72
2 3 31
2 18 23
2 28 41
2 29 18
1 47
1 81
1 83
2 15 18
2 20 41
2 35 46
2 43 19
1 89
1 75
1 54
2 36 40
2 14 32
2 1 19
2 38 44
2 36 3
2 23 26
1 19
2 31 30
1 6
2 33 49
2 2 32
2 2 43
2 2 30
1 94
2 14 50
1 21
2 43 33
2 49 13
2 49 2
1 80
2 12 2
2 49 2
1 46
2 49 15
1 67
1 55
2 49 8
2 49 2
2 38 3
2 49 2
1 29
2 1 49
1 38
1 59
2 49 2
2 32 33
2 12 22
1 16
1 8
2 3 2
2 49 2
2 10 12
2 45 33
1 5
1 98
1 2
1 73
2 49 2
1 39
2 31 10
1 62
2 10 12
2 49 22
2 12 49
1 9
2 22 10
2 10 22
2 27 19
1 4
2 48 25
1 86
2 22 10
2 36 50
2 18 23
2 22 33
2 10 22
2 22 23
2 40 44
2 10 22
2 10 22
2 22 12
1 50
1 68
2 12 23
2 12 23
1 17
2 23 12
2 12 23
2 23 33
2 41 2
1 13
2 17 12
2 22 10
2 33 2
2 22 10
1 84
2 10 22
1 18
1 63
2 12 33
1 53
2 40 49
1 7
2 12 23
2 39 40
2 12 1
2 2 49
1 74
2 39 40
1 60
2 39 2
2 40 23
2 10 23
2 12 42
2 12 40
1 78
2 2 49
1 14
2 23 37
2 2 49
1 66
2 49 2
2 23 12
1 3
2 36 49
2 12 49
2 5 4
2 21 45
2 23 39
2 10 22
2 45 39
2 23 12
2 2 6
2 50 8
2 10 22
1 57
1 70
2 39 11
2 12 22
1 27
1 64
2 45 21
2 23 49
2 40 39
1 79
1 76
2 10 2
2 39 23
1 56
2 42 48
2 22 2
1 71
2 36 48
2 29 16
1 34
2 42 21
2 23 33
2 31 24
2 15 31
1 58
1 90
2 39 40
2 40 39
2 49 21
2 21 45
1 48
1 25
2 23 2
2 40 39
1 10
1 51
2 8 37
2 23 49
2 32 11
2 49 40
2 8 35
2 21 33
2 43 24
2 24 36
2 40 21
2 35 45
1 52
1 100
2 48 32
1 88
1 12
2 10 12
2 36 23
2 21 45
1 28
2 33 10
1 32
2 15 12
2 21 45
2 46 34
2 46 5
2 15 38
1 49
1 69
2 40 39
2 23 33
1 35
1 99
1 85
1 45
2 38 21
1 96
2 25 30
1 15
2 1 16
1 24
2 21 48
1 44
2 4 8
2 45 10
1 31
2 38 11
2 8 38
1 92
2 30 35
2 47 17
2 26 46
2 12 36
2 14 25
2 32 9
2 14 25
2 9 36
1 65
1 42
2 7 49
2 26 43
2 4 5
2 33 22
2 50 8
1 37
1 22
2 8 11
1 33
2 33 32
2 26 46
2 36 8
2 28 17
1 87
1 40
2 29 20
1 77
2 24 35
1 93
1 95
2 2 17
2 25 14
2 36 12
2 15 49
2 26 46
1 61
2 50 12
2 4 47
2 8 49
2 42 11
2 16 37
1 82
2 47 4
1 43
2 38 9
2 13 10
1 97
